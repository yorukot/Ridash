# Repository Guidelines

## Project Structure & Module Organization
- `cmd/main.go` boots the Echo server, wiring middleware, database, and routes; `router/` defines route groups and attaches handlers.
- `handler/` holds HTTP handlers for auth and team flows; `middleware/` centralizes auth/logging middleware; `utils/` covers config/env loading, IDs, logging, crypto, and response helpers.
- `repository/` encapsulates DB access; `models/` contains persisted structs; `migrations/` holds SQL applied at startup; `db/` manages the PG pool and migration runner.
- `docs/` contains Swagger artifacts generated by `make generate-docs`; `tmp/` stores build outputs; `compose.yaml` provides a local Timescale/Postgres service; `.env.example` lists required envs.

## Setup, Build & Run
- Copy `.env.example` to `.env` and fill secrets; start the DB with `docker compose up -d`.
- Build once with `make build` (outputs `tmp/radish`); run via `make run`.
- For live reload, install `air` and use `make dev`.
- Lint with `make lint` (`go fmt`, `go vet`, `golint`); clean artifacts with `make clean`.
- Regenerate Swagger after handler changes: `make generate-docs`.

## Coding Style & Naming Conventions
- Go formatting is canonical (`go fmt` tabs, 1TBS braces); keep imports organized and prefer stdlib-first grouping.
- Use Conventional Package naming: lower_snake for folders, PascalCase for exported types, lowerCamel for unexported identifiers. Keep handler functions imperative (e.g., `Register`, `OAuthCallback`).
- Prefer context-first signatures and structured logging with `zap.L()`. Return typed errors and HTTP responses through `utils/response`.

## Testing Guidelines
- Use Goâ€™s standard `testing` package; run `go test ./...`. Favor table-driven tests and `httptest` + Echo for handler contracts.
- Name files `*_test.go` and functions `Test<Thing>`; mirror package paths (e.g., `handler/auth`).
- For DB-facing tests, target a disposable database (e.g., via `docker compose`) and clean up with transactions or fixtures.

## Database & Migrations
- Migrations live in `migrations/` and auto-run at startup via `db.Migrator()`. Add sequential files like `2_add_teams.up.sql` and matching `.down.sql`.
- Keep SQL idempotent where possible and document breaking changes in PRs. Update `.env` defaults if new envs are required.

## Commit & Pull Request Guidelines
- Follow observed Conventional Commits (`feat:`, `fix:`, `feat(scope):`); use concise, imperative subjects and include a scope when touching a specific area (e.g., `feat(auth): refresh tokens`).
- PRs should describe intent, list key changes, reference issues, and call out migrations, new env vars, and Swagger regenerations. Include test evidence (`go test ./...`) and screenshots only when UI/API examples are relevant (e.g., Swagger snippet or curl sample).
